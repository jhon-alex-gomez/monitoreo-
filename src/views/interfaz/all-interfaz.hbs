<table class="table table-hover">
  <thead>
    <tr>
      <th scope="col">Nombre Interfaz</th>
      <th scope="col">Token</th>
      <th scope="col">Visualizar</th>
      <th scope="col">Editar</th>
      <th scope="col">Eliminar</th>
    </tr>
  </thead>
  <tbody>
    {{#each interfaz}}
    <tr class="table-active">
      <th scope="row">{{name}}</th>
      <td>{{sensor_codigo}}</td>
      <td>
        <button class="btn btn-primary" onclick="toggleDevice('{{_id}}')" aria-label="Encender o apagar dispositivo">
          Encender/Apagar
        </button>
      </td>
      <td>
        <a href='/interfaz/visualizar-sensor/{{_id}}' class="btn btn-block" style="background-color: #B0E57C; color: #fff;">Visualizar</a>
      </td>
      <td>
        <a href='/interfaz/edit-sensor/{{_id}}' class="btn btn-block" style="background-color: #B0E57C; color: #fff;">Editar</a>
      </td>
      <td>
        <form action='/interfaz/delete-sensor/{{_id}}?_method=DELETE' method="post" id="deleteForm{{_id}}">
          <input type="hidden" name="_method" value="DELETE">
          <button type="button" class="btn btn-danger" onclick="confirmDelete('{{_id}}')">
            Delete
          </button>
        </form>
      </td>
    </tr>
    {{/each}}
  </tbody>
</table>

<script>
  function confirmDelete(sensorId) {
    if (confirm("¿Estás seguro de que deseas eliminar este elemento?")) {
      document.getElementById("deleteForm" + sensorId).submit();
    }
  }

  function toggleDevice(sensorId) {
    fetch('/interfaz/toggle/' + sensorId, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ action: 'toggle' })
    })
    .then(response => response.json())
    .then(data => {
      alert(data.message || 'Comando enviado');
    })
    .catch(error => {
      console.error('Error:', error);
      alert('No se pudo enviar el comando');
    });
  }
</script>
